/*
 *  Tracy configuration for OpenGL ES 2.0
 */

name:       "gles20"

apiheaders:
[
    "gl2.h"
]

tracer:
{
    systemincludes:
    [
        "GLES2/gl2.h"
        /* This is still needed for the GL extension tracer init code */
        "EGL/egl.h"
    ]

    hooks:
    [
        "gl_hooks_tracer.c"
    ]
}

player:
{
    systemincludes:
    [
        "GLES2/gl2.h"
        /* This is still needed for the GL extension tracer init code */
        "EGL/egl.h"
    ]

    hooks:
    [
        "gl_hooks_player.c"
    ]
}

/* Symbian specific configuration */
symbian:
{
    tracer:
    {
        uid1:       "0x1000008D"
        uid2:       "FIXME"
        capability: "ALL -TCB"
        vendorid:   "0"

        symbol_map:
        {
            "libglesv2_bwinsu.def": "libglesv2_orig.dll"
        }

        deffiles:
        [
            "libglesv2_bwinsu.def"
        ]
    }

    passthrough_tracer:
    {
        uid1:       "0x1000008D"
        uid2:       "FIXME"
        capability: "ALL -TCB"
        vendorid:   "0"

        /* Redirect internal functions up to this ordinal
         * to the original DLL
         */
        max_internal_ordinal: 300

        symbol_map:
        {
            "../../cross-api/common/common.def": "master-tracer.dll" 
            "default": "libglesv2_cm_orig.dll"
        }

        deffiles:
        [
            "libglesv2_bmarmu.def"
        ]
    }

    player:
    {
        uid1:       "0x1000008D"
        uid2:       "0xa007011a"
        capability: "None"
        vendorid:   "0"

        libraries:
        [
            "libGLESv2.lib"
        ]
    }
}

/* Unix specific configuration */
unix:
{
    systemincludes:
    [
        "GLES2/gl2.h"
        "string.h"
    ]

    tracer:
    {
        library:    "libGLESv2.so"
    }

    player:
    {
        libraries:
        [
            "GLESv2"
        ]
    }
}

win32:
{
    includedirs:
    [
        "../libraries/amd_gles2_emulator/include"
    ]

    librarydirs:
    [
        "../libraries/amd_gles2_emulator/lib"
    ]

    passthrough_tracer:
    {
        sources:
        [
            "../libraries/amd_gles2_emulator/gles2_internal_exports.c"
        ]
        symbol_map:
        {
            "gl2.h": "gles20-egl13-tracer.dll" 
        }
    }

    tracer:
    {
        /* For AMD's OpenGL ES 2.0 wrapper */
        disable_stdcall_mangling: 1

        symbol_map:
        {
            "gl2.h": "libGLESv2_orig.dll" 
        }
    }

    macros:
    {
        "_DLL_EXPORTS": 1
    }

    player:
    {
        libraries:
        [
            "libGLESv2.lib"
        ]
    }
}

/* Code used by the C exporter of the analyzer */
c_player_code:
[
    "gl_c_player.c"
]

/* Mapping from special GL objects to custom objects */
types:
{
    /* GL enumerations */
    GLenum(decorationhint = "GL_"):             enum
    GLshader(namespace = "ctx.root_ctx"):       object
    GLprogram(namespace = "ctx.root_ctx"):      object
    GLattribute(namespace = "ctx.program"):     object
    GLuniform(namespace = "ctx.program"):       object
    GLshadersourceline:                         object
    GLshaderbinary:                             object
    GLshadertype:                               object
    GLprecisiontype:                            object
    GLframebuffer(namespace = "ctx.root_ctx"):  object
    GLrenderbuffer(namespace = "ctx.root_ctx"): object
}

/* Special function attributes */
functions:
{
    glReadPixels(framemarker = 1):
    {
        pixels:
        {
            metatype(class = "image", stride = "width", height = "height"):
            [
                components(condition = "format", value = "GL_LUMINANCE_ALPHA", result = "2")
                components(condition = "format", value = "GL_RGB", result = "3")
                components(condition = "format", value = "GL_RGBA", result = "4")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_5_6_5", result = "short")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_5_5_5_1", result = "short")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_4_4_4_4", result = "short")
            ]
        }
    }
    glBindBuffer(runtimestate = 1):
    {
        target:           "ctx.buffer"
        buffer:           "ctx.buffer.handle"
    }
    glBindFramebuffer:
    {
        framebuffer(object_class = "GLframebuffer")
    }
    glBindRenderbuffer:
    {
        renderbuffer(object_class = "GLrenderbuffer")
    }
    glBindTexture:
    {
        target:           "ctx.texunit.target"
        texture:          "ctx.texunit.target.handle"
        /* Also set the current texture object */
        @copy(src = "ctx.texunit.target.handle", dest = "ctx.texture")
    }
    glBlendFunc:
    {
        sfactor(decorationhint = "GL_"):   "ctx.blend_src"
        dfactor(decorationhint = "GL_"):   "ctx.blend_dest"
    }
    glClear:
    {
        mask(decoration = "bitfield", decorationhint = "GL_.+BIT")
    }
    glClearColor:
    {
        red:              "ctx.clear_r"
        green:            "ctx.clear_g"
        blue:             "ctx.clear_b"
        alpha:            "ctx.clear_a"
    }  
    glClearDepthf:
    {
        depth:            "ctx.clear_z"
    }  
    glClearStencil:
    {
        s:                "ctx.clear_s"
    }  
    glColorMask:
    {
        red:              "ctx.colormask_r"
        green:            "ctx.colormask_g"
        blue:             "ctx.colormask_b"
        alpha:            "ctx.colormask_a"
    }
    /* TODO: Compressed texture images may define multiple mipmaps */
    glCompressedTexImage2D:
    {
        target:           "ctx.texunit.target"
        level:            "ctx.texture.level"
        internalformat:   "ctx.texture.level.internalformat"
        width:            "ctx.texture.level.width"
        height:           "ctx.texture.level.height"
        border:           "ctx.texture.level.border"
        data:
        {
            metatype(class = "array", size = "imageSize", type = "byte")
        }
        @set:             "ctx.texture.level.pixels"
    }
    /* TODO: Compressed texture images may define multiple mipmaps */
    glCompressedTexSubImage2D:
    {
        target:           "ctx.texunit.target"
        level:            "ctx.texture.level"
        data:
        {
            metatype(class = "array", size = "imageSize", type = "byte")
        }
        @modify:          "ctx.texture.level.pixels"
    }
    glCopyTexImage2D:
    {
        target:           "ctx.texunit.target"
        level:            "ctx.texture.level"
        internalformat:   "ctx.texture.level.internalformat"
        width:            "ctx.texture.level.width"
        height:           "ctx.texture.level.height"
        @set:             "ctx.texture.level.pixels"
    }
    glCopyTexSubImage2D:
    {
        target:           "ctx.texunit.target"
        level:            "ctx.texture.level"
        @modify:          "ctx.texture.level.pixels"
    }
    glCullFace:
    {
        mode:             "ctx.cull_mode"
    }
    glDeleteBuffers:
    {
        buffers:
        {
            metatype(class = "array", size = "n")
        }
    }
    glDeleteTextures:
    {
        textures:
        {
            metatype(class = "array", size = "n")
        }
    }
    glDepthFunc:
    {
        func:             "ctx.depth_func"
    }
    glDepthMask:
    {
        flag:             "ctx.depth_mask"
    }
    glDepthRangef:
    {
        zNear:            "ctx.depth_near"
        zFar:             "ctx.depth_far"
    }
    glDisable:
    {
        cap(decoration = "enum"):   "ctx.capability"
        @set:                       "ctx.capability.state"
    }
    glDrawElements(rendercall = 1):
    {
        mode(decorationhint = "GL_")
    }
    glDrawArrays(rendercall = 1):
    {
        mode(decorationhint = "GL_")
    }
    glEnable:
    {
        cap(decoration = "enum"):   "ctx.capability"
        @set:                       "ctx.capability.state"
    }
    glFinish:
    {
    }
    glFlush:
    {
    }
    glFramebufferRenderbuffer:
    {
       renderbuffer(object_class = "GLrenderbuffer")
    }
    glFrontFace:
    {
        mode:             "ctx.front_face"
    }
    glGenBuffers:
    {
        buffers:
        {
            metatype(class = "array", size = "n")
        }
    }
    glGenTextures:
    {
        textures:
        {
            metatype(class = "array", size = "n")
        }
    }
    glGetBooleanv:
    {
        params:
        {
            metatype(class = "array", size = 1):
            [
                size(condition = "pname", value = "GL_SAMPLE_COVERAGE_INVERT", result = "1")
                size(condition = "pname", value = "GL_COLOR_WRITEMASK", result = "4")
                size(condition = "pname", value = "GL_DEPTH_WRITEMASK", result = "1")
                size(condition = "pname", value = "GL_SHADER_COMPILER", result = "1")
                
            ]
        }
    }
    
    glGetFloatv:
    {
        params:
        {
            metatype(class = "array", size = 1):
            [
                size(condition = "pname", value = "GL_DEPTH_RANGE", result = "2")
                size(condition = "pname", value = "GL_LINE_WIDTH", result = "1")
                size(condition = "pname", value = "GL_POLYGON_OFFSET_FACTOR", result = "1")
                size(condition = "pname", value = "GL_POLYGON_OFFSET_UNITS", result = "1")
                size(condition = "pname", value = "GL_SAMPLE_COVERAGE_VALUE", result = "1")
                size(condition = "pname", value = "GL_COLOR_CLEAR_VALUE", result = "1")
                size(condition = "pname", value = "GL_ALIASED_POINT_SIZE_RANGE", result = "2")
                size(condition = "pname", value = "GL_ALIASED_LINE_WIDTH_RANGE", result = "2")
            ]
        }
    }
    
    glGetIntegerv:
    {
        params:
        {
            metatype(class = "array", size = 1):
            [
                size(condition = "pname", value = "GL_ARRAY_BUFFER_BINDING", result = "1")
                size(condition = "pname", value = "GL_ELEMENT_ARRAY_BUFFER_BINDING", result = "1")
                size(condition = "pname", value = "GL_VIEWPORT", result = "4")
                size(condition = "pname", value = "GL_CULL_FACE_MODE", result = "1")
                size(condition = "pname", value = "GL_FRONT_FACE", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_BINDING_2D", result = "8")
                size(condition = "pname", value = "GL_TEXTURE_BINDING_CUBE_MAP", result = "8")
                size(condition = "pname", value = "GL_ACTIVE_TEXTURE", result = "1")
                size(condition = "pname", value = "GL_SCISSOR_BOX", result = "4")
                size(condition = "pname", value = "GL_STENCIL_FUNC", result = "1")
                
                size(condition = "pname", value = "GL_STENCIL_VALUE_MASK", result = "1")
                size(condition = "pname", value = "GL_STENCIL_REF", result = "1")
                size(condition = "pname", value = "GL_STENCIL_FAIL", result = "1")
                size(condition = "pname", value = "GL_STENCIL_PASS_DEPTH_FAIL", result = "1")
                size(condition = "pname", value = "GL_STENCIL_PASS_DEPTH_PASS", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BACK_FUNC", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BACK_VALUE_MASK", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BACK_REF", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BACK_FAIL", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BACK_PASS_DEPTH_FAIL", result = "1")
                
                size(condition = "pname", value = "GL_STENCIL_BACK_PASS_DEPTH_PASS", result = "1")
                size(condition = "pname", value = "GL_DEPTH_FUNC", result = "1")
                size(condition = "pname", value = "GL_BLEND_SRC_RGB", result = "1")
                size(condition = "pname", value = "GL_BLEND_SRC_ALPHA", result = "1")
                size(condition = "pname", value = "GL_BLEND_DST_RGB", result = "1")
                size(condition = "pname", value = "GL_STENCIL_WRITEMASK", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BACK_WRITEMASK", result = "1")
                size(condition = "pname", value = "GL_DEPTH_CLEAR_VALUE", result = "1")
                size(condition = "pname", value = "GL_STENCIL_CLEAR_VALUE", result = "1")
                size(condition = "pname", value = "GL_UNPACK_ALIGNMENT", result = "1")
               
                size(condition = "pname", value = "GL_PACK_ALIGNMENT", result = "1")
                size(condition = "pname", value = "GL_CURRENT_PROGRAM", result = "1")
                size(condition = "pname", value = "GL_GENERATE_MIPMAP_HINT", result = "1")
                size(condition = "pname", value = "GL_SUBPIXEL_BITS", result = "1")
                size(condition = "pname", value = "GL_MAX_TEXTURE_SIZE", result = "1")
                size(condition = "pname", value = "GL_MAX_CUBE_MAP_TEXTURE_SIZE", result = "1")
                size(condition = "pname", value = "GL_MAX_VIEWPORT_DIMS", result = "2")
                size(condition = "pname", value = "GL_SAMPLE_BUFFERS", result = "1")
                size(condition = "pname", value = "GL_SAMPLES", result = "1")
                size(condition = "pname", value = "GL_COMPRESSED_TEXTURE_FORMATS", result = "0")
                
                size(condition = "pname", value = "GL_NUM_COMPRESSED_TEXTURE_FORMATS", result = "1")
                size(condition = "pname", value = "GL_SHADER_BINARY_FORMATS", result = "1")
                size(condition = "pname", value = "GL_NUM_SHADER_BINARY_FORMATS", result = "1")
                size(condition = "pname", value = "GL_MAX_VERTEX_ATTRIBS", result = "1")
                size(condition = "pname", value = "GL_MAX_VERTEX_UNIFORM_VECTORS", result = "1")
                size(condition = "pname", value = "GL_MAX_VARYING_VECTORS", result = "1")
                size(condition = "pname", value = "GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS", result = "1")
                size(condition = "pname", value = "GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS", result = "1")
                size(condition = "pname", value = "GL_MAX_TEXTURE_IMAGE_UNITS", result = "1")
                size(condition = "pname", value = "GL_MAX_FRAGMENT_UNIFORM_VECTORS", result = "1")
                
                size(condition = "pname", value = "GL_MAX_RENDERBUFFER_SIZE", result = "1")
                size(condition = "pname", value = "GL_DEPTH_BITS", result = "1")
                size(condition = "pname", value = "GL_STENCIL_BITS", result = "1")
                size(condition = "pname", value = "GL_IMPLEMENTATION_COLOR_READ_TYPE", result = "1")
                size(condition = "pname", value = "GL_IMPLEMENTATION_COLOR_READ_FORMAT", result = "1")
                size(condition = "pname", value = "GL_RENDERBUFFER_BINDING", result = "1")
                size(condition = "pname", value = "GL_FRAMEBUFFER_BINDING", result = "1")
  
            ]
        }
    }
    glGetBufferParameteriv:
    {
         params:
        {
            metatype(class = "array", size = 1):
            [
                size(condition = "pname", value = "GL_BUFFER_SIZE", result = "1")
                size(condition = "pname", value = "GL_BUFFER_USAGE", result = "1")
                /* Miksi n‰m‰ on niiss‰ speksien taulukossa mutta k‰‰nt‰j‰ kuitenkin ilmoittaa 
                ett‰ ne olisivat undeclared identifier? */
                //size(condition = "pname", value = "GL_BUFFER_ACCESS", result = "1")
                //size(condition = "pname", value = "GL_BUFFER_MAPPED", result = "1")
            ]
        }
    }
    glGetError:
    {

    }
    glGetString:
    {
    }
    glGetTexParameterfv:
    {
        params:
        {
            metatype(class = "array", size = 1):
            [
                /*
                size(condition = "pname", value = "GL_TEXTURE_PRIORITY", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_MIN_LOD", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_MAX_LOD", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_BASE_LEVEL", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_MAX_LEVEL", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_LOD_BIAS", result = "1")
                N‰iss‰ sama homma
                */
            ]
        }
    }
    glGetTexParameteriv:
    {
        params:
        {
            metatype(class = "array", size = 1):
            [
                /*
                size(condition = "pname", value = "GL_TEXTURE_RESIDENT", result = "1")
                size(condition = "pname", value = "GL_DEPTH_TEXTURE_MODE", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_COMPARE_MODE", result = "1")
                size(condition = "pname", value = "GL_TEXTURE_COMPARE_FUNC", result = "1")
                N‰iss‰ sama homma
                */ 
            ]
        }
    }
    glHint:
    {
        target:           "ctx.hint"
        mode:             "ctx.hint.mode"
    }
    glIsBuffer:
    {
    }
    glIsFramebuffer:
    {
        framebuffer(object_class = "GLframebuffer")
    }
    glIsRenderbuffer:
    {
        renderbuffer(object_class = "GLrenderbuffer")
    }
    glIsEnabled:
    {
    }
    glIsTexture:
    {
    }
    glLineWidth:
    {
        width:            "ctx.line_width"
    }
    glPixelStorei:
    {
        pname:            "ctx.pixelstore_parameter"
        param:            "ctx.pixelstore_parameter.value"
    }
    glPolygonOffset:
    {
        factor:           "ctx.polygon_offset_factor"
        units:            "ctx.polygon_offset_units"
    }
    glSampleCoverage:
    {
        value:            "ctx.sample_coverage_value"
        invert:           "ctx.sample_coverage_invert"
    }
    glScissor:
    {
        x:                "ctx.scissor_x"
        y:                "ctx.scissor_y"
        width:            "ctx.scissor_width"
        height:           "ctx.scissor_height"
    }
    glStencilFunc:
    {
        func:             "ctx.stencil_func"
        ref:              "ctx.stencil_ref"
        mask:             "ctx.stencil_mask"
    }
    glStencilMask:
    {
        mask:             "ctx.stencil_writemask"
    }
    glStencilOp:
    {
        fail:             "ctx.stencilop_fail"
        zfail:            "ctx.stencilop_zfail"
        zpass:            "ctx.stencilop_zpass"
    }
    glTexParameterf:
    {
        target:           "ctx.texunit.target"
        pname:            "ctx.texture.parameter"
        param:            "ctx.texture.parameter.value"
    }
    glTexParameteri:
    {
        target:           "ctx.texunit.target"
        pname:            "ctx.texture.parameter"
        param(decoration="enum", decorationhint="GL_"): "ctx.texture.parameter.value"
    }
    glTexParameterfv:
    {
        target:           "ctx.texunit.target"
        pname:            "ctx.texture.parameter"
        params:
        {
            state: "ctx.texture.parameter.value"
            metatype(class = "array", size = 1)
        }
    }
    glTexParameteriv:
    {
        target:           "ctx.texunit.target"
        pname:            "ctx.texture.parameter"
        params:
        {
            state: "ctx.texture.parameter.value"
            metatype(class = "array", size = 1)
        }
    }
    glViewport:
    {
        x:                "ctx.viewport_x"
        y:                "ctx.viewport_y"
        width:            "ctx.viewport_width"
        height:           "ctx.viewport_height"
    }
    glTexImage2D:
    {
        level:            "ctx.texture.level"
        internalformat:   "ctx.texture.level.internalformat"
        width:            "ctx.texture.level.width"
        height:           "ctx.texture.level.height"
        border:           "ctx.texture.level.border"
        pixels:
        {
            state:        "ctx.texture.level.pixels"
            metatype(class = "image", stride = "width", height = "height"):
            [
                components(condition = "type", value = "GL_UNSIGNED_SHORT_5_6_5", result = "1")
                components(condition = "type", value = "GL_UNSIGNED_SHORT_5_5_5_1", result = "1")
                components(condition = "type", value = "GL_UNSIGNED_SHORT_4_4_4_4", result = "1")
                components(condition = "format", value = "GL_LUMINANCE_ALPHA", result = "2")
                components(condition = "format", value = "GL_RGB", result = "3")
                components(condition = "format", value = "GL_RGBA", result = "4")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_5_6_5", result = "short")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_5_5_5_1", result = "short")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_4_4_4_4", result = "short")
            ]
        }
    }
    glTexSubImage2D:
    {
        level:            "ctx.texture.level"
        pixels:
        {
            state:        "ctx.texture.level.pixels"
            metatype(class = "image", stride = "width", height = "height"):
            [
                components(condition = "type", value = "GL_UNSIGNED_SHORT_5_6_5", result = "1")
                components(condition = "type", value = "GL_UNSIGNED_SHORT_5_5_5_1", result = "1")
                components(condition = "type", value = "GL_UNSIGNED_SHORT_4_4_4_4", result = "1")
                components(condition = "format", value = "GL_LUMINANCE_ALPHA", result = "2")
                components(condition = "format", value = "GL_RGB", result = "3")
                components(condition = "format", value = "GL_RGBA", result = "4")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_5_6_5", result = "short")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_5_5_5_1", result = "short")
                type(condition = "type", value = "GL_UNSIGNED_SHORT_4_4_4_4", result = "short")
            ]
        }
        @modify:          "ctx.texture.level.pixels"
    }
    glActiveTexture:
    {
        texture:          "ctx.texunit"
        @copy(src = "ctx.texunit.target.handle", dest = "ctx.texture")
    }
    glBufferData(runtimestate = 1):
    {
        target:           "ctx.buffer"
        size:             "ctx.buffer.handle.size"
        data:
        {
            metatype(class = "array", size = "size", type = "byte")
        }
        usage:            "ctx.buffer.handle.usage"
    }
    glBufferSubData(runtimestate = 1):
    {
        target:           "ctx.buffer"
        size:             "ctx.buffer.handle.size"
        data:
        {
            metatype(class = "array", size = "size", type = "byte")
        }
        @modify:          "ctx.buffer.handle.data"
    }
    glCreateProgram:
    {
        @return(object_class = "GLprogram")
    }
    glDeleteProgram:
    {
        program(object_class = "GLprogram")
    }
    glIsProgram:
    {
        program(object_class = "GLprogram")
    }
    glLinkProgram:
    {
        program(object_class = "GLprogram")
    }
    glUseProgram(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
    }
    glValidateProgram:
    {
        program(object_class = "GLprogram")
    }
    glCreateShader:
    {
        @return(object_class = "GLshader")
    }
    glAttachShader:
    {
        program(object_class = "GLprogram")
        shader(object_class = "GLshader")
    }
    glCompileShader:
    {
        shader(object_class = "GLshader")
    }
    glDeleteShader:
    {
        shader(object_class = "GLshader")
    }
    glDetachShader:
    {
        program(object_class = "GLprogram")
        shader(object_class = "GLshader")
    }
    glGetAttachedShaders:
    {
        program(object_class = "GLprogram")
        count:
        {
            metatype(class = "array", size = "1")
        }
        shaders(object_class = "GLshader"):
        {
            metatype(class = "array", size = "maxcount")
        }
    }
    glIsShader:
    {
        shader(object_class = "GLshader")
    }
    glShaderSource:
    {
        shader(object_class = "GLshader")
        string(object_class = "GLshadersourceline"):
        {
            metatype(class = "array", size = "count")
        }
        length:
        {
            metatype(class = "array", size = "count")
        }
    }
    glGetAttribLocation(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        name:
        {
            metatype(class = "array", size = "strlen(name)+1")
        }
        @return(object_class = "GLattribute")
    }
    glBindAttribLocation(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        index(object_class = "GLattribute", out = 1)
        name:
        {
            metatype(class = "array", size = "strlen(name)+1")
        }
    }
    glDeleteFramebuffers:
    {
        framebuffers(object_class = "GLframebuffer"):
        {
            metatype(class = "array", size = "n")
        }
    }
    glGenFramebuffers:
    {
        framebuffers(object_class = "GLframebuffer"):
        {
            metatype(class = "array", size = "n")
        }
    }
    glGenRenderbuffers:
    {
        renderbuffers(object_class = "GLrenderbuffer"):
        {
            metatype(class = "array", size = "n")
        }
    }
    glGetActiveAttrib(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        index(object_class = "GLattribute")
        length:
        {
            metatype(class = "array", size = "1")
        }
        size:
        {
            metatype(class = "array", size = "1")
        }
        type:
        {
            metatype(class = "array", size = "1")
        }
        name:
        {
            metatype(class = "array", size = "bufsize")
        }
    }
    glGetActiveUniform(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        index(object_class = "GLuniform")
        length:
        {
            metatype(class = "array", size = "1")
        }
        size:
        {
            metatype(class = "array", size = "1")
        }
        type:
        {
            metatype(class = "array", size = "1")
        }
        name:
        {
            metatype(class = "array", size = "bufsize")
        }
    }
    glGetFramebufferAttachmentParameteriv:
    {
        /* In ES 2.0, only single values are returned */
        params:
        {
            metatype(class = "array", size = "1")
        }
    }
    glGetProgramiv:
    {
        program(object_class = "GLprogram")
        /* In ES 2.0, only single values are returned */
        params:
        {
            metatype(class = "array", size = "1")
        }
    }
    glGetProgramInfoLog:
    {
        program(object_class = "GLprogram")
        length:
        {
            metatype(class = "array", size = "1")
        }
        infolog:
        {
            metatype(class = "array", size = "bufsize")
        }
    }
    glGetRenderbufferParameteriv:
    {
        /* In ES 2.0, only single values are returned */
        params:
        {
            metatype(class = "array", size = "1")
        }
    }
    glGetShaderiv:
    {
        shader(object_class = "GLshader")
        /* In ES 2.0, only single values are returned */
        params:
        {
            metatype(class = "array", size = "1")
        }
    }
    glGetShaderInfoLog:
    {
        shader(object_class = "GLshader")
        length:
        {
            metatype(class = "array", size = "1")
        }
        infolog:
        {
            metatype(class = "array", size = "bufsize")
        }
    }
    glEnableVertexAttribArray(runtimestate = 1):
    {
        index(object_class = "GLattribute"): "ctx.vertex_attrib_array"
    }
    glDisableVertexAttribArray(runtimestate = 1):
    {
        index(object_class = "GLattribute"): "ctx.vertex_attrib_array"
    }
    glVertexAttribPointer(runtimestate = 1):
    {
        indx(object_class = "GLattribute"):           "ctx.vertex_attrib_array"
        size:           "ctx.vertex_attrib_array.size"
        type:           "ctx.vertex_attrib_array.type"
        normalized:     "ctx.vertex_attrib_array.normalized"
        stride:         "ctx.vertex_attrib_array.stride"
        ptr:            "ctx.vertex_attrib_array.pointer"
    }
    
    glDeleteRenderbuffers:
    {
        renderbuffers(object_class = "GLrenderbuffer"):
        {
            metatype(class = "array", size = "n")
        }
    }
    
    glGetShaderSource:
    {
        shader(object_class = "GLshader")
        length:
        {
            metatype(class = "array", size = "1")
        }
        source:
        {
            metatype(class = "array", size = "bufsize")
        }
    }
    
    glGetUniformfv(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        location(object_class = "GLuniform")
        params:
        {
            metatype(class = "array", size = 1)
        }
    }
    
    glGetUniformiv(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        location(object_class = "GLuniform")
        params:
        {
            metatype(class = "array", size = 1)
        }
    }
    
    glGetUniformLocation(runtimestate = 1):
    {
        program(object_class = "GLprogram"): "ctx.program"
        name:
        {
            metatype(class = "array", size = "strlen(name)+1")
        }
        @return(object_class = "GLuniform")
    }
    
    glGetVertexAttribfv:
    {
        index(object_class = "GLattribute")
        params:
        {
            metatype(class = "array", size = 1)
        }
    }
   
    glGetVertexAttribiv:
    {
        index(object_class = "GLattribute")
        params:
        {
            metatype(class = "array", size = 1)
        }
    }
   
    glGetVertexAttribPointerv:
    {
        index(object_class = "GLattribute")
        pointer:
        {
            metatype(class = "array", size = 1, type = "byte")
        }
    }
    
    glShaderBinary:
    {
        binaryformat:               ctx.shader_binary_format
            
        shaders(object_class = "GLshader"):
        {
            metatype(class = "array", size = "n")
        }
    }
    
    glUniform1f:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:      "ctx.uniform.x"
    }

    glUniform1fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 1")
        }
        
    }

    glUniform1i:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:      "ctx.uniform.x"
    }
    
    glUniform1iv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 1")
        }
    
    }
    
    glUniform2f:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:              "ctx.uniform.x" 
        y:              "ctx.uniform.y"
    }
    
    glUniform2fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 2")
        }
    }

    glUniform2i:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:              "ctx.uniform.x" 
        y:              "ctx.uniform.y"
    }
    
    glUniform2iv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 2")
        }
    }
    
    glUniform3f:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:              "ctx.uniform.x" 
        y:              "ctx.uniform.y"
        z:              "ctx.uniform.z"
    }

    glUniform3fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 3")
        }
    }

    glUniform3i:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:              "ctx.uniform.x" 
        y:              "ctx.uniform.y"
        z:              "ctx.uniform.z"
    }
    
    glUniform3iv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 3")
        }
    }
    
    glUniform4f:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:              "ctx.uniform.x" 
        y:              "ctx.uniform.y"
        z:              "ctx.uniform.z"
        w:              "ctx.uniform.w"
    }

    glUniform4fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 4")
        }
    }
    
    glUniform4i:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        x:              "ctx.uniform.x" 
        y:              "ctx.uniform.y"
        z:              "ctx.uniform.z"
        w:              "ctx.uniform.w"
    }

    glUniform4iv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
    
        v:
        {
            state: "ctx.uniform.value"
            metatype(class = "array", size = "count * 4")
        }
    }
    
    glUniformMatrix2fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        
        value:
        {
            state:                  "ctx.uniform.value"
            metatype(class = "array", size = "count * 2 * 2")
        }
    }
    
    glUniformMatrix3fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        
        value:
        {
            state:                  "ctx.uniform.value"
            metatype(class = "array", size = "count * 3 * 3")
        }
    }
    
    glUniformMatrix4fv:
    {
        location(object_class = "GLuniform"): "ctx.uniform"
        
        value:
        {
            state:                  "ctx.uniform.value"
            metatype(class = "array", size = "count * 4 * 4")
        }
    }
    
    glVertexAttrib1f:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        x:                                  "ctx.vertex_attribute.x"
    }
    
    glVertexAttrib1fv:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        
        values:
        {
            state:                      "ctx.vertex_attribute.value"
            metatype(class = "array", size = "1")
        }
    }
    
    glVertexAttrib2f:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        x:                              "ctx.vertex_attribute.x"
        y:                              "ctx.vertex_attribute.y"
    }
    
    glVertexAttrib2fv:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        values:
        {
            state:                      "ctx.vertex_attribute.value"
            metatype(class = "array", size = "2")
        }
    }
    
    glVertexAttrib3f:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        x:                              "ctx.vertex_attribute.x"
        y:                              "ctx.vertex_attribute.y"
        z:                              "ctx.vertex_attribute.z"
    }

    glVertexAttrib3fv:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        values:
        {
            state:                  "ctx.vertex_attribute.value"
            metatype(class = "array", size = "3")
        }
    }
    
    glVertexAttrib4f:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        x:                              "ctx.vertex_attribute.x"
        y:                              "ctx.vertex_attribute.y"
        z:                              "ctx.vertex_attribute.z"
        w:                              "ctx.vertex_attribute.w"
    }
    
    glVertexAttrib4fv:
    {
        indx(object_class = "GLattribute"): "ctx.vertex_attribute"
        values:
        {
            state:                  "ctx.vertex_attribute.value"
            metatype(class = "array", size = "4")
        }
    }
    
    glGetShaderPrecisionFormat:
    {
        shadertype(object_class = "GLshadertype")
        precisiontype(object_class = "GLprecisiontype")
        
        range:
        {
            metatype(class = "array", size = "1")
        }
        precision:
        {
            metatype(class = "array", size = "1")
        }
        
    }
}

/* State tracking support */
state:
{
    /* GLES context */
    ctx:
    {
        /* Main shared context */
        root_ctx

        /* Server texture unit */
        texunit:
        {
            /* 1D, 2D or TEXTURE_ENV */
            target:
            {
                /* Bound texture handle */
                handle
                
                /* Texture environment */
                parameter:
                {
                    value
                }
            }
        }
        
        /* Textures */
        texture:
        {
            /* Mipmap level */
            level:
            {
                internalformat
                    width
                height
                border
                pixels
            }
            
            parameter:
            {
                value
            }
        }   
        
        /* Buffer object */
        buffer:
        {
            handle:
            {
                size
                data
                usage
            }
        }
        
        /* Uniforms */
        uniform:
        {
                value
                x
                y
                z
                w
        }
        
        
        /* Vertex attribute array */
        vertex_attrib_array:
        {
            enabled
            type
            size
            normalized
            stride
            pointer
            binding
        } 
        
        /* Vertex attributes */ 
        vertex_attribute:
        {
            value
            x
            y
            z
            w
        }

        /* Current program */
        program

        /* Greatest used vertex attrib array index */
        vertex_attrib_array_max_index
        
        /* Clear color, depth and stencil */
        clear_r
        clear_g
        clear_b
        clear_a
        clear_z
        clear_s
        
        /* Shader binary format */
        shader_binary_format  
        
        /* Rendering hints */
        hint:
        {
            mode
        }
        
        /* Line rendering width */
        line_width
        
        /* Sample coverage */
        sample_coverage_value
        sample_coverage_invert
        
        /* Depth comparison function */
        depth_func
        
        /* Polygon offset */
        polygon_offset_factor
        polygon_offset_units
        
        /* Color mask */
        colormask_r
        colormask_g
        colormask_b
        colormask_a
        
        /* Culling */
        cull_mode
        front_face
        
        /* Viewport */
        viewport_x
        viewport_y
        viewport_width
        viewport_height
        
        /* Scissor */
        scissor_x
        scissor_y
        scissor_width
        scissor_height
        
        /* Depth range and mask */
        depth_near
        depth_far
        depth_mask
        
        /* Stenciling */
        stencil_func
        stencil_ref
        stencil_mask
        stencil_writemask
        stencilop_fail
        stencilop_zpass
        stencilop_zfail
        
        /* Blending equation */
        blend_src
        blend_dest
        
        /* Pixel store */
        pixelstore_parameter:
        {
            value
        }
        
        /* Rendering state */
        capability:
        {
            state
        }
    }
}
